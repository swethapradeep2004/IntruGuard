<!doctype html>
<html>

<head>
  <title>IntruGuard | SOC Command Center</title>

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />

  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
</head>

<body class="soc-body">
  <!-- ================= TOP BAR ================= -->
  <div class="soc-topbar">
    <div class="soc-left">
      <span class="blink-dot"></span>
      <strong>INTRUGUARD SOC</strong>
      <span class="ml-3">| SYSTEM STATUS: <span class="status-live">LIVE</span></span>
    </div>

    <div class="soc-right">
      <span class="mr-3">ADMIN: {{ session['user'] }}</span>
      <a href="{{ url_for('logout') }}" class="btn btn-sm btn-danger">LOGOUT</a>
    </div>
  </div>

  <!-- ================= DASHBOARD GRID ================= -->
  <div class="soc-container">
    <!-- Flash Messages (Absolute Positioned) -->
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div
      style="position: absolute; top: 10px; left: 50%; transform: translateX(-50%); z-index: 1000; width: auto; min-width: 300px;">
      {% for category, message in messages %}
      <div class="alert alert-{{ category }} alert-dismissible fade show text-center shadow-lg" role="alert">
        {{ message }}
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

    <!-- LEFT PANEL -->
    <div class="soc-panel">
      <h5>SYSTEM INTELLIGENCE</h5>
      <ul>
        <li>ML Models Loaded: <span class="green">YES</span></li>
        <li>Scaler Initialized: <span class="green">YES</span></li>
        <li>Packet Monitor: <span class="green">ACTIVE</span></li>
        <li>Web IDS Engine: <span class="green">ACTIVE</span></li>
      </ul>
    </div>

    <!-- CENTER PANEL -->
    <div class="soc-panel main-panel">
      <h4>INTRUSION DETECTION MODULES</h4>

      <div class="module-card">
        <h5>Network Intrusion Detection</h5>
        <p>
          Analyze network packet flows for DoS, Probe, Botnet, Malware
          attacks.
        </p>
        <a href="{{ url_for('upload', mode='network') }}" class="btn btn-outline-info">
          LAUNCH NETWORK SCAN
        </a>
      </div>

      <div class="module-card mt-4">
        <h5>Web Intrusion Detection</h5>
        <p>
          Detect SQL Injection, XSS, CSRF and malicious HTTP request patterns.
        </p>
        <a href="{{ url_for('upload', mode='web') }}" class="btn btn-outline-warning">
          LAUNCH WEB SCAN
        </a>
      </div>

      <div class="module-card mt-4" style="border-color: #00ff88;">
        <h5>Live Traffic Monitor (Simulation)</h5>
        <p>
          Real-time packet flow simulation and anomaly detection.
        </p>
        <a href="{{ url_for('live_monitor') }}" class="btn btn-outline-success">
          START LIVE MONITOR
        </a>
      </div>
    </div>
  </div>

  <!-- ================= TERMINAL LOG ================= -->
  <div class="terminal-box">
    <p>> Initializing IDS engine...</p>
    <p>> Loading RandomForest models...</p>
    <p>> Monitoring traffic streams...</p>
    <p class="blink-text">> Awaiting admin command â–ˆ</p>
  </div>
  <!-- Animated Background Effects -->
  <div class="bg-grid"></div>

  <!-- Bootstrap JS & jQuery (Required for Alert Dismiss) -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
